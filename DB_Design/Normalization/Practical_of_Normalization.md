# Normalization(정규화)



## 테이블과 릴레이션

- 릴레이션은 외형적으로는 일반 테이블과 똑같이 보이지만 그 성질에 있어 조금 다름

  - 한 릴레이션에 포함된 튜플들은 모두 상이
    - 튜플의 유일성
    - 두 개의 똑같은 투플은 한 릴레이션에 포함될 수 없음
  - 한 릴레이션에 포함된 튜플 사이에는 순서가 없음
    - 튜플의 무순서성

- **릴레이션과 테이블 비교**

  <img src="..\..\img\image-20201020131951818.png" alt="image-20201020131951818" style="zoom:80%;" /> 

  - 무순서성은 동일
  - 보통 릴레이션을 구현한 구현체를 테이블이라하고, 테이블의 논리적인 이름을 릴레이션이라고 표현
    - 릴레이 션은 추상적 개념(abstract concept)이고 테이블은 이 릴레이션을 외부로 기술하는 하나의 구체적인 표현 (concrete representation)인 것



## 비정규화된 테이블

- 데이터가 있는 정규화되지 않은 상태의 테이블 (테이블이지만 릴레이션이 아닌 상태)
- 속성의 원자성이 확립되지 않은 상태
  - Case 1 : 행(컬럼, Column) 단위로 반복된 속성**(Repeating Value)**이 있는 상태
  - Case 2 : 열(로우, Row) 단위로 반복된 Row**(Repeating Value)**이 있는 상태



## 1차 정규화

- 1차 정규화의 대상: **비정규화 테이블**
- 모든 도메인이 원자값(atomic value)만으로 된 릴레이션
- 속성의 원자화(Atomic value, Repeating Value 분리)

- **1차 정규화 수행 방법**
  - **방법 1) PK조정에 의한 원자값 확보**
  - **방법 2) 릴레이션 도출에 의한 원자값 확보**

​	 <img src="..\..\img\image-20201020135625900.png" alt="image-20201020135625900" style="zoom:80%;" />



## 2차 정규화

- 부분함수 종속성 분리

- 2차 정규화가 필요한 경우

  - 1NF이고, 키에 속하지 않는 애트리뷰트들은 **모두 기본키에 완전 함수 종속이 아닐 때**

- **무손실 분해(nonloss decomposition)**

- 1NF 이상의 원인

  - 기본키에 부분 함수 종속된 애트리뷰트가 존재
    - 기본키로 식별되는 개체와 무관한 애트리뷰트가 존재
    - 두가지 상이한 정보가 포함

- 1NF 이상의 해결

  - 프로젝션으로 릴레이션을 분해 (부분 함수 종속을 제거)

    **:point_right: 2NF**

 <img src="..\..\img\image-20201020140402570.png" alt="image-20201020140402570" style="zoom:80%;" />



## 3차 정규화

- **이행함수 종속성 분리**
- 3차 정규화가 필요한 경우
  - 2NF이고, 키가 아닌 모든 애트리뷰트들은 **기본키에 이행적 함수 종속되지 않은 상태일 때**
  - 2NF이고, 일반속성( 애트리뷰트) 들에 함수 종속 존재하면 3차 정규화 수행

 <img src="..\..\img\image-20201020142749195.png" alt="image-20201020142749195" style="zoom:80%;" />



 	<img src="..\..\img\image-20201020144900022.png" alt="image-20201020144900022" style="zoom:80%;" />

- **3차 정규화를 수행하면 비식별관계(점선)**



## 보이스코드 정규화

- **결정자 함수 종속성 분리**

  - 결정자가 결정자를 종속할 때
  - 결정자 안에 있는 컬럼들끼리 종속 관계를 분리

- 3NF의 약점

  - 복수의 후보키를 가질 경우 and

  - 후보키들이 복합 애트리뷰트들로 구성될 경우 and

  - 후보키들이 서로 중첩되는 경우

    **:point_right: 3차 정규화 적용 불가능**

    - 보다 일반적인 Boyce/Codd Normal Form(BCNF)을 제안

- 릴레이션 R의 모든 결정자가 후보키이면 릴레이션 R은 BCNF에 속함

- 릴레이션 R이 BCNF에 속하면 R은 제1, 제2, 제3 정규형에 속함

- 강한 제3정규형(strong 3NF)

   <img src="..\..\img\image-20201020144528985.png" alt="image-20201020144528985" style="zoom:80%;" />

  

   <img src="..\..\img\image-20201020145909805.png" alt="image-20201020145909805" style="zoom:80%;" />

## 4차 정규화

- **다치 종속 (MVD, Multi-Valued Dependency)**
  - 릴레이션 R(A,B,C)에서 어떤 (A, C)값에 대응하는 B값의 집합이 A값에만 종속되고 C값에 독립이면 다치 종속
- MVD를 가진 릴레이션의 분해(Fagin의 정리)
  - R(A,B,C)에서 MVD A → B|C이면 R1(A,B)와 R2(A,C)로 무손실 분해 가능
- **릴레이션 R에서 MVD A → B가 존재할 때 R의 모든 애트리뷰트들이 A에 함수 종속(FD)이면 R은 4NF**	<img src="..\..\img\image-20201020173535393.png" alt="image-20201020173535393" style="zoom:80%;" />

 <img src="..\..\img\image-20201020174711474.png" alt="image-20201020174711474" style="zoom:80%;" />

- **과목과 교수는 관련이 있고, 과목과 교재는 관련이 있지만 교수와 교재 간 관련이 없음**



## 5차 정규화

- 조인 종속(JD, Join Dependency)

- JD를 만족하는 n-분해 릴레이션은 n개의 프로젝션으로 분해

- n-분해

  - **조인의 갯수만큼 분해**

- **5차 정규화 전제 조건**

  - PK에서 발생
  - 독립된 속성간의 조인 연관성이 있어야 함
  - A,B,C가 있을 때 A-B, A-C, B-C는 연관성이 있으나, A-B-C는 연관성이 없는데도 불구하고 하나의 릴레이션에 PK로 사용이 될 때 발생이 됨

- 업무적인 제약조건을 반드시 확인해서 정규화 진행

- **JD가 존재하지 않거나( 즉, 릴레이션이 더 이상 무손실 분해될 수 없거나 ), JD에 의해 분해되는 Projection들이 원래 릴레이션의 Candidate Key를 유지 할 때 5NF**

   <img src="..\..\img\image-20201020174558200.png" alt="image-20201020174558200" style="zoom:80%;" />

