## Normalization(정규화)



### 함수종속성(Functional Dependency)

- 데이터들이 **어떤 기준값에 의해 항상 종속**되는 현상
- X와 Y를 임의의 애트리뷰트들의 집합이라고 할 때, **X의 값이 Y의 값을 유일하게(unique) 결정한다면 “X는 Y를 함수적으로 결정한다(functionally determines)”**라고 함
- **X → Y**로 표기하고, “**Y는 X에 함수적으로 종속된다**” 라고 함
  - X : 결정자(determinant), Y : 종속자(dependent)



#### 함수적 종속성의 검사 방법

- 릴레이션 인스턴스 r(R)에 속하는 어떠한 임의의 두 투플에 대해서도 속성들의 집합 X에 대해 동일한 값을 가질 때마다 Y에 대해서도 동일한 값을 가진다면 X → Y라는 함수적 종속성이 성립



#### 완전함수종속과 부분함수종속, 이행함수종속, 결정자 함수종속

- **완전함수종속**
  
  - Full Functional Dependency
- 복합 속성 X에 대하여 X →Y가 성립할 때, X’ ⊂ X 이고 X’ → Y 를 만족하는 속성 X'이 존재하지 않음
  
- **부분함수종속(2NF)**

  - Partial Functional Dependency
  - 복합 속성 X에 대하여 X → Y가 성립할 때, X’ ⊂ X 이고 X’ → Y 를 만족하는 속성 X'이 존재 가능

   ![image-20201019231013556](..\..\img\image-20201019231013556.png)

  

- **이행함수종속(3NF)**

  - Transitive Dependence
  - 릴레이션 R에서 속성 A→X이고 X→Y이면 A→Y임

   ![image-20201019231247105](..\..\img\image-20201019231247105.png)

  

- **결정자 함수종속**

  - 결정자 간의 함수 종속성
  - 보이스코드 정규화의 대상

- 예시)

   ​	<img src="..\..\img\image-20201019231429225.png" alt="image-20201019231429225" style="zoom:80%;" />

  



### 암스트롱의 공리(Armstrong's axioms)

- 속성들의 종속관계들을 표현한 식
- 암스트롱의 공리는 함수적 종속성들에 관한 올바르고(Sound) 완전한(Complete) 추론들의 집합
- 릴레이션 R에 대해 X, Y, Z라는 속성의 집합이 주어졌을 경우 **여러 가지 함수종속 성질을 유도해 낼 수 있는 추론 규칙**



#### 암스트롱의 공리(Armstrong's axioms)의 기본 규칙과 부가규칙

- :fire:**암기**:fire:

  ​	<img src="..\..\img\image-20201019232646632.png" alt="image-20201019232646632" style="zoom:80%;" />

  

- **폐포(Closure)**

  - 암스트롱의 공리를 이용해 나올 수 있는 함수적 종속성들의 집합
  - FD의 집합 F의 폐포(closure) : F+
  - F로부터 추론할 수 있는 모든 가능한 함수적 종속성들의 집합

- **덮는다(Cover)**

  - G의 모든 FD가 F로부터 추론될 수 있다면,  “F가 G를 덮는다(cover)” 라고 표현

- **최소(minimal)**

  - 다음 세 조건을 만족하는 FD 집합을 최소라고 함
    1. F의 모든 함수적 종속성들의 오른쪽편 애트리뷰트가 하나
    2. F로부터 어떤 함수적 종속성을 제거했을 때, F와 동등한 함수적 종속성들의 집합이 될 수 없음
    3.  F에서 X→A를 X의 진부분집합 Y에 대하여 Y→A로 교체했을 때, F와 동등한 함수적 종속성들의 집합이 될 수 없음



### 이상현상(Anomaly)

- 데이터의 중복성으로 인해 릴레이션을 조작할 때 발생하는 비합리적 현상
- 이상현상 발생의 원인
  - 여러 가지 종류의 사실들을 하나의 릴레이션으로 표현하려고 하기 때문에
  - 속성들간에 존재하는 여러 가지 종속 관계에 대해 **정규화가 실행되지 않았기 때문에**
- 이상현상의 해결
  - 하나의 릴레이션에는 하나의 종속성이 표현되 도록 분해(Decomposition), 스키마 변환 (schema transformation)
  - **정규화**



#### 이상현상의 종류

- **갱신이상 (Update Anomaly)**

  - 릴레이션 R 에서 특정 속성 값 갱신 시 **중복 저장되어 있는 속성 값 중 하나만 갱신하고, 나머지는 갱신하지 않아서 발생하는 데이터의 불일치 현상(Data Inconsistency)**

- **삭제이상 (Deletion Anomaly)**

  - 릴레이션 R 에서 특정 투플을 삭제할 경우 **원하지 않는 정보까지도 삭제되는 현상**

- **삽입이상 (Insertion Anomaly)**

  - 릴레이션 R 에서 특정 투플을 삽입할 경우 **원하지 않는 불필요한 정보까지도 삽입해야 하는 현상**

- 예시)

   ​	![image-20201019234836210](..\..\img\image-20201019234836210.png)

  - 삭제 이상
    - 200번 학생이 'C123'의 등록을 취소하면, 3학년이라는 정보도 함께 삭제됨
      - 연쇄 삭제(triggered deletion)에 의한 정보의 손실 (loss of information)
  - 삽입이상
    - 600번 학생이 2학년이라는 사실을 삽입하려 할 때, 어떤 과목을 등록하지 않는 한 삽입이 불가능
      - 과목 번호가 기본키이기 때문에
  - 갱신이상
    - 400번 학생의 학년을 4에서 3으로 변경하려 할 때, 학번이 400인 4개의 튜플 모두를 갱신시켜야 함



### 정규화 이론(1차~5차 정규화)

- 정규형(Normal Form)
  - 어떤 일련의 제약 조건을 만족하는 릴레이션으로 만족한 상태임. 즉 **정규화를 완료한 상태**
- **정규화(Normalization)**
  - 제약조건을 만족하지 않기 때문에 그것을 만족하기 위한 **과정으로서의 의미**
  - 관계형 데이터 모델에서 데이터의 중복성을 제거하여 이상현상을 방지하고 **데이터의 일관성과 정확성을 유지 하기 위한 과정**
  - 속성(Attribute)들간의 종속성(Dependency)을 분석하여 기본적으로 **하나의 종속성이 하나의 릴레이션 (Relation)으로 표현되도록 분해해 나가는 과정**
  - 이상 현상(Anomaly)을 야기하는 Attribute 간의 종속 관계를 제거하기 위해 Relation을 작은 Relation으로 **무손실 분해하는 과정**

- 정규화의 필요성
  - 중복의 제거로 저장 공간의 최소화
  - 중복성 삭제로 일관성 및 무결성 보장
  - 자료의 삽입, 갱신 및 삭제에 따른 이상현상(Anomaly) 제거
  - 데이터 신규 발생시 DB 재구성의 필요성을 감소(유연한 구조)
- 정규화의 적용 원칙
  - 정보의 무손실
    - 분해된 Relation이 표현하는 정보는 분해되기 전의 정보를 모두 포함하고 있어야 하며, 보다 더 바람직한 구조여야 함
  - 데이터 중복성 감소
    - 중복으로 인한 이상 현상의 제거
  - 분리의 원칙
    - 하나의 독립된 관계성은 하나의 독립된 Relation으로 분리하여 표현



#### 정규화의 과정

- 상위 단계는 하위 단계의 정규형을 만족한 이후 수행
- 무손실 분해

​	 ![image-20201020000440360](..\..\img\image-20201020000440360.png)



#### 정규화 이론

​	![image-20201020000915488](..\..\img\image-20201020000915488.png)

- 상위 단계는 하위 단계를 포함